import pandas as pd
from azureml.core.model import Model
from azureml.core import Workspace
from azureml.core import Run
import json
import os
import numpy as np
import joblib
from pathlib import Path
from inference_schema.schema_decorators import input_schema, output_schema
from inference_schema.parameter_types.numpy_parameter_type import NumpyParameterType
import pickle
import xgboost as xgb
from scipy.signal import savgol_filter


model_path = os.path.join(os.getenv('AZUREML_MODEL_DIR'), 'raman_model_nb','1','XGBoost_ramman_model.h5')
scale_path = os.path.join(os.getenv('AZUREML_MODEL_DIR'),'scale_raman','1','scale_raman.h5')

input_sample = np.array([[21578,22181,22626,22745,22668,22561,22542,22581,22601,22589,22633,22738,22783,22718,22701,22758,22831,22751,22476,22221,22070,22070,22024,21901,21825,21902,22025,22031,21871,21755,21798,21986,22131,22190,22111,22033,22023,22052,22048,21962,21952,21984,21983,21921,21835,21729,21544,21316,21215,21226,21254,21192,20968,20595,20249,20136,20202,20276,20247,20236,20301,20402,20468,20419,20291,20125,19958,19799,19736,19764,19865,19838,19671,19433,19303,19442,19653,19714,19628,19540,19540,19625,19716,19747,19765,19761,19761,19780,19892,20071,20192,20179,20096,19955,19890,19942,19992,19870,19665,19682,19930,20202,20291,20160,19899,19667,19553,19508,19539,19592,19640,19640,19630,19700,19795,19836,19787,19665,19606,19676,19810,19930,19976,20002,19996,19939,19883,19895,19991,20176,20321,20346,20209,19947,19675,19539,19558,19598,19526,19354,19175,19067,18987,18888,18748,18670,18647,18553,18373,18206,18186,18221,18167,17982,17786,17831,18121,18443,18609,18642,18696,18823,18912,18857,18674,18483,18359,18446,18573,18592,18494,18474,18617,18751,18795,18778,18807,18768,18722,18747,18795,18821,18752,18709,18713,18718,18651,18573,18591,18668,18714,18708,18645,18587,18529,18419,18284,18241,18275,18272,18260,18235,18271,18239,18138,17983,17870,17838,17785,17676,17539,17442,17413,17451,17573,17721,17837,17949,18082,18248,18338,18293,18102,17894,17773,17666,17596,17538,17555,17622,17697,17721,17744,17759,17735,17629,17566,17629,17764,17847,17809,17717,17592,17491,17318,17103,16903,16829,16914,17040,17045,16859,16640,16479,16367,16254,16124,16018,15953,15833,15659,15426,15205,15017,14866,14743,14625,14534,14399,14235,14020,13725,13424,13242,13233,13278,13226,13012,12823,12732,12675,12595,12532,12527,12593,12624,12574,12433,12306,12253,12328,12492,12710,12907,13075,13222,13409,13597,13733,13841,13965,14072,14194,14313,14438,14595,14708,14718,14659,14634,14649,14635,14646,14650,14632,14567,14492,14443,14527,14697,14887,14994,15032,15059,15080,15050,14990,14934,14908,14916,14970,15070,15168,15263,15382,15578,15831,16023,16162,16319,16503,16711,16797,16744,16654,16628,16721,16865,17020,17167,17338,17561,17803,18028,18273,18465,18578,18680,18812,18995,19235,19433,19583,19714,19930,20297,20647,20984,21279,21653,22137,22726,23351,23964,24543,25122,25718,26340,27015,27722,28522,29389,30251,31127,32007,32929,33903,34804,35620,36387,37165,38045,38965,39904,40722,41412,41987,42641,43447,44394,45310,46106,46763,47323,47873,48402,48884,49345,49843,50345,50753,51052,51327,51577,51837,52050,52205,52296,52328,52366,52426,52559,52626,52616,52539,52440,52305,52129,51861,51444,50900,50342,49878,49457,49083,48673,48146,47535,46932,46354,45782,45137,44415,43608,42742,41891,41003,40159,39358,38630,37965,37280,36543,35810,35113,34497,33919,33355,32794,32180,31529,30945,30489,30136,29804,29494,29167,28838,28488,28156,27836,27561,27306,27081,26859,26682,26572,26480,26338,26173,25935,25669,25345,25024,24833,24807,24906,25054,25146,25172,25128,25029,24914,24822,24773,24717,24688,24669,24686,24748,24825,24879,24897,24918,24924,24934,24909,24878,24843,24833,24907,25057,25176,25259,25330,25365,25403,25462,25567,25683,25788,25844,25910,25981,26100,26169,26125,26023,25942,25908,25933,25927,25844,25793,25772,25792,25769,25732,25778,25850,25917,25960,25933,25908,25926,25940,25894,25821,25819,25898,26012,26091,26065,25950,25865,25830,25870,25933,25908,25809,25684,25626,25649,25679,25687,25691,25684,25726,25830,25907,25994,26087,26135,26106,26040,26014,26071,26221,26415,26582,26735,26898,27133,27385,27647,27891,28079,28254,28382,28514,28665,28870,29096,29335,29609,29819,29884,29839,29777,29802,29963,30220,30545,30840,31051,31113,31114,31087,31150,31248,31318,31455,31650,31918,32182,32351,32398,32367,32330,32314,32342,32441,32590,32778,32986,33138,33258,33310,33348,33419,33609,33805,33915,33911,33823,33747,33690,33696,33731,33809,33895,33962,34004,33983,33974,33966,34037,34199,34413,34594,34765,34889,35040,35209,35330,35351,35332,35389,35562,35911,36324,36703,36989,37197,37313,37425,37616,37857,38132,38329,38467,38599,38775,38961,39162,39323,39463,39575,39711,39915,40138,40328,40512,40688,40861,41099,41392,41686,41947,42178,42360,42469,42545,42625,42744,42957,43208,43506,43852,44197,44541,44886,45258,45633,45973,46262,46596,46944,47364,47802,48201,48505,48744,49002,49316,49649,49985,50251,50413,50568,50765,51042,51334,51615,51805,51962,52144,52370,52636,52843,52962,52933,52904,52946,53162,53466,53768,53970,54128,54267,54429,54579,54704,54790,54865,54939,55000,55043,55102,55215,55340,55461,55564,55650,55768,55885,56043,56201,56391,56526,56611,56667,56750,56813,56885,56958,56992,56984,57004,56985,56922,56867,56837,56822,56831,56793,56717,56566,56377,56184,56012,55834,55634,55391,55169,55031,54940,54824,54619,54349,54037,53754,53549,53361,53190,52976,52711,52415,52138,51909,51756,51635,51512,51309,51042,50783,50604,50478,50394,50335,50266,50228,50181,50131,50068,50126,50361,50783,51358,52102,53043,54161,55510,57077,58824,60773,62917,65229,67741,70331,72910,75334,77459,79198,80532,81401,81744,81554,80764,79397,77541,75357,72929,70389,67742,65042,62443,60023,57852,55980,54374,53019,51975,51188,50631,50204,49821,49522,49297,49118,48997,48896,48793,48759,48819,48915,49004,49106,49186,49280,49393,49512,49591,49582,49512,49474,49530,49644,49796,49909,49935,49926,49901,49912,49914,49881,49799,49688,49652,49662,49702,49754,49778,49787,49751,49688,49543,49369,49296,49383,49528,49645,49693,49677,49763,49995,50320,50619,50819,50933,51015,51154,51397,51717,52141,52672,53243,53912,54684,55545,56471,57485,58573,59709,60884,62127,63451,64799,66211,67621,69022,70390,71729,72933,73995,74885,75565,76031,76206,76055,75571,74809,73856,72798,71698,70614,69598,68670,67878,67179,66570,66029,65613,65253,64987,64784,64592,64435,64371,64386,64428,64470,64482,64511,64629,64812,65028,65244,65481,65784,66154,66549,67016,67492,67996,68546,69065,69562,70088,70650,71245,71918,72583,73173,73691,74202,74760,75366,76072,76772,77465,78139,78764,79351,79902,80480,81058,81617,82181,82746,83239,83743,84238,84764,85285,85848,86381,86921,87469,88070,88693,89321,89951,90476,90898,91162,91337,91436,91482,91551,91582,91617,91563,91377,91061,90725,90393,90098,89817,89562,89349,89269,89330,89550,89880,90287,90750,91235,91772,92329,92900,93487,94103,94738,95361,95972,96478,96884,97208,97535,97905,98340,98837,99323,99765,100130,100340,100420,100420,100270,99995,99570,99055,98451,97716,96823,95745,94505,93166,91775,90412,89104,87824,86563,85313,84047,82771,81500,80343,79342,78549,77990,77567,77146,76732,76326,75959,75608,75219,74823,74457,74105,73814,73559,73281,72966,72622,72356,72195,72060,71941,71761,71569,71375,71294,71331,71421,71525,71628,71686,71715,71760,71869,72082,72402,72834,73365,73965,74620,75318,75989,76682,77351,78030,78741,79462,80249,81058,81900,82695,83447,84134,84680,85050,85290,85422,85455,85390,85264,85140,84951,84711,84425,84119,83807,83556,83352,83177,82988,82769,82545,82242,81913,81563,81242,80954,80726,80574,80463,80333,80113,79852,79573,79284,78928,78627,78408,78243,78130,78079,78042,78034,78064,78173,78340,78454,78587,78689,78801,78943,79117,79289,79481,79774,80312,81342,82959,85146,87664,90028,91557,91818,90686,88472,85709,83038,80850,79363,78476,77989,77729,77543,77387,77286,77275,77317,77441,77578,77716,77863,77990,78133,78300,78483,78631,78762,78882,79047,79224,79437,79641,79875,80165,80551,81053,81686,82404,83169,83931,84698,85499,86334,87336,88521,89842,91264,92754,94221,95639,97070,98507,99929,101280,102540,103710,104880,106010,107040,107900,108570,109140,109690,110290,110880,111360,111750,112110,112440,112840,113320,113910,114590,115420,116340,117400,118560,119760,120900,121880,122620,123130,123430,123570,123580,123500,123280,122990,122600,122220,121860,121480,121100,120750,120410,120200,120100,120080,120090,120150,120170,120110,119930,119610,119130,118570,117890,117180,116460,115750,115120,114710,114510,114670,115160,115900,116840,117940,119140,120450,121780,123100,124300,125270,125920,126200,126050,125410,124320,122810,120990,118950,116840,114750,112830,111140,109760,108760,108100,107700,107510,107490,107610,107870,108270,108770,109260,109730,110170,110570,111040,111720,112670,113910,115520,117410,119570,121840,124040,125910,127230,127790,127570,126590,125000,123020,120820,118630,116580,114810,113300,112060,110970,110020,109240,108580,108060,107620,107180,106730,106290,105860,105460,105100,104780,104460,104140,103780,103390,103010,102600,102140,101630,101130,100630,100220,99826,99490,99154,98845,98589,98367,98222,98183,98162,98127,98037,97830,97499,97050,96514,95972,95501,95138,94867,94653,94483,94292,94056,93829,93624,93518,93539,93621,93719,93785,93758,93648,93436,93143,92751,92339,91936,91600,91346,91162,91024,90916,90825,90795,90835,90981,91184,91458,91747,92044,92324,92593,92949,93447,94147,95088,96226,97481,98846,100350,102030,103970,106170,108590,111190,113900,116670,119470,122230,124860,127220,129240,130790,131900,132590,132970,133120,133130,132990,132750,132460,132110,131760,131410,131070,130680,130230,129730,129240,128710,128160,127580,126920,126210,125490,124820,124210,123670,123160,122730,122320,121920,121510,121080,120620,120100,119570,119080,118580,118080,117560,117010,116450,115860,115240,114580,113900,113220,112550,111970,111500,111110,110850,110710,110650,110730,110950,111240,111640,112170,112870,113780,114890,116220,117740,119440,121340,123430,125740,128240,130820,133310,135620,137650,139410,140900,142180,143230,144010,144570,144900,145090,145200,145180,145010,144730,144390,144070,143870,143780,143760,143730,143600,143380,143070,142650,142150,141490,140670,139660,138530,137290,136080,134940,133850,132840,131820,130750,129640,128570,127580,126730,126080,125560,125140,124760,124380,124060,123780,123570,123380,123230,123150,123150,123300,123490,123780,124070,124310,124490,124570,124580,124620,124720,124870,125090,125360,125710,126080,126450,126850,127230,127600,127940,128280,128730,129310,129980,130700,131330,131880,132270,132540,132780,132970,133230,133540,133830,134100,134390,134740,135160,135630,136150,136700,137190,137630,138030,138450,138980,139590,140240,140940,141720,142560,143500,144530,145660,146940,148510,150360,152490,154960,157730,160860,164340,168210,172370,176630,180650,184160,186830,188460,188850,187950,185800,182610,178750,174580,170500,166780,163590,160930,158710,156810,155140,153760,152650,151830,151250,150820,150560,150400,150400,150530,150810,151200,151610,152060,152470,152860,153290,153760,154280,154830,155380,155850,156230,156510,156670,156830,156970,157170,157380,157600,157790,157890,157970,158040,158140,158220,158280,158330,158360,158400,158510,158700,158910,159090,159300,159550,159870,160270,160700,161180,161620,161990,162310,162600,162840,163040,163240,163400,163520,163640,163810,164060,164380,164790,165240,165700,166120,166490,166820,167060,167270,167430,167610,167830,168130,168490,168940,169460,170000,170530,171040,171440,171790,172090,172390,172690,172960,173250,173520,173870,174320,174880,175490,176110,176690,177150,177470,177680,177880,178130,178560,179120,179790,180490,181160,181780,182370,182930,183510,184090,184730,185410,186090,186800,187450,187990,188440,188860,189200,189540,189870,190260,190630,190980,191280,191550,191860,192230,192650,193110,193520,193890,194290,194730,195230,195730,196270,196850,197410,197970,198520,199060,199570,200110,200690,201350,202070,202850,203690,204600,205630,206860,208450,210530,213240,216680,220760,225260,229760,233700,236550,237800,237220,234990,231630,227810,224070,220870,218320,216420,215000,213900,213110,212550,212170,211890,211680,211450,211270,211180,211280,211580,212000,212520,213060,213560,214040,214510,215040,215560,216090,216610,217080,217460,217770,218040,218250,218450,218670,218950,219310,219780,220330,220940,221580,222250,223000,223900,224950,226100,227360,228680,230040,231360,232730,234100,235460,236840,238150,239300,240240,240950,241450,241830,242110,242370,242550,242740,242940,243240,243720,244420,245370,246500,247790,249140,250460,251790,253190,254690,256420,258380,260530,262860,265320,267860,270550,273390,276380,279540,282850,286330,289980,293720,297400,300840,303820,306030,307270,307380,306240,303960,300720,296860,292720,288520,284500,280740,277270,274130,271330,268880,266820,265220,264110,263440,263130,263070,263210,263490,263880,264390,265220,266540,268430,270880,273640,276310,278480,279850,280360,280180,279600,278930,278330,277990,277890,278010,278210,278470,278840,279460,280440,281780,283370,285070,286590,287740,288300,288340,288130,288280,289740,293680,301240,312990,328560,346390,363860,377900,385740,385780,378100,364420,347570,330580,315830,304580,296960,292350,289770,288350,287450,286780,286210,285690,285260,284900,284620,284410,284240,284130,284040,283970,283920,283880,283900,284000,284210,284530,284940,285500,286240,287190,288340,289690,291140,292570,293890,294970,295760,296280,296620,296840,297050,297320,297640,298020,298450,298840,299250,299670,300210,300890,301690,302560,303400,304180,304910,305610,306290,306990,307710,308320,308820,309160,309340,309420,309500,309570,309690,309850,310000,310140,310340,310570,310940,311360,311880,312450,313040,313600,314090,314490,314860,315170,315520,315900,316380,316930,317520,318100,318640,319110,319550,320010,320490,321000,321520,322050,322630,323200,323800,324330,324770,325080,325250,325340,325440,325570,325800,326120,326520,326950,327320,327650,327900,328140,328410,328760,329170,329670,330140,330570,330920,331260,331610,332030,332560,333200,333880,334610,335340,336060,336790,337530,338310,339100,339910,340680,341380,342060,342720,343380,344090,344880,345780,346820,347900,349010,350090,351200,352350,353490,354600,355680,356680,357680,358670,359700,360820,362020,363320,364620,365920,367260,368570,369870,371220,372570,373870,375120,376300,377530,378850,380310,381850,383480,385120,386680,388210,389730,391290,393030,394960,397060,399210,401280,403250,405150,406990,408870,410890,413060,415430,417960,420570,423280,426010,428710,431320,433800,436120,438400,440790,443480,446820,451020,456230,462540,469490,476530,482900,488050,491330,492540,491990,489940,0,0
]])

output_sample = np.array([
    {
 '1300': 0,
 '1299': 0,
 '1298': 0,
 '1297': 0,
 '1296': 0,
 '1295': 0,
 '1294': 0,
 '1293': 0,
 '1292': 0,
 '1291': 0,
 '1290': 0,
 '1289': 0,
 '1288': 0,
 '1287': 0,
 '1286': 0,
 '1285': 0,
 '1284': 0,
 '1283': 0,
 '1282': 0,
 '1281': 0,
 '1280': 0,
 '1279': 0,
 '1278': 0,
 '1277': 0,
 '1276': 0,
 '1275': 0,
 '1274': 0,
 '1273': 0,
 '1272': 0,
 '1271': 0,
 '1270': 0,
 '1269': 0,
 '1268': 0,
 '1267': 0,
 '1266': 0,
 '1265': 0,
 '1264': 0,
 '1263': 0,
 '1262': 0,
 '1261': 0,
 '1260': 0,
 '1259': 0,
 '1258': 0,
 '1257': 0,
 '1256': 0,
 '1255': 0,
 '1254': 0,
 '1253': 0,
 '1252': 0,
 '1251': 0,
 '1250': 0,
 '1249': 0,
 '1248': 0,
 '1247': 0,
 '1246': 0,
 '1245': 0,
 '1244': 0,
 '1243': 0,
 '1242': 0,
 '1241': 0,
 '1240': 0,
 '1239': 0,
 '1238': 0,
 '1237': 0,
 '1236': 0,
 '1235': 0,
 '1234': 0,
 '1233': 0,
 '1232': 0,
 '1231': 0,
 '1230': 0,
 '1229': 0,
 '1228': 0,
 '1227': 0,
 '1226': 0,
 '1225': 0,
 '1224': 0,
 '1223': 0,
 '1222': 0,
 '1221': 0,
 '1220': 0,
 '1219': 0,
 '1218': 0,
 '1217': 0,
 '1216': 0,
 '1215': 0,
 '1214': 0,
 '1213': 0,
 '1212': 0,
 '1211': 0,
 '1210': 0,
 '1209': 0,
 '1208': 0,
 '1207': 0,
 '1206': 0,
 '1205': 0,
 '1204': 0,
 '1203': 0,
 '1202': 0,
 '1201': 0,
 '1200': 0,
 '1199': 0,
 '1198': 0,
 '1197': 0,
 '1196': 0,
 '1195': 0,
 '1194': 0,
 '1193': 0,
 '1192': 0,
 '1191': 0,
 '1190': 0,
 '1189': 0,
 '1188': 0,
 '1187': 0,
 '1186': 0,
 '1185': 0,
 '1184': 0,
 '1183': 0,
 '1182': 0,
 '1181': 0,
 '1180': 0,
 '1179': 0,
 '1178': 0,
 '1177': 0,
 '1176': 0,
 '1175': 0,
 '1174': 0,
 '1173': 0,
 '1172': 0,
 '1171': 0,
 '1170': 0,
 '1169': 0,
 '1168': 0,
 '1167': 0,
 '1166': 0,
 '1165': 0,
 '1164': 0,
 '1163': 0,
 '1162': 0,
 '1161': 0,
 '1160': 0,
 '1159': 0,
 '1158': 0,
 '1157': 0,
 '1156': 0,
 '1155': 0,
 '1154': 0,
 '1153': 0,
 '1152': 0,
 '1151': 0,
 '1150': 0,
 '1149': 0,
 '1148': 0,
 '1147': 0,
 '1146': 0,
 '1145': 0,
 '1144': 0,
 '1143': 0,
 '1142': 0,
 '1141': 0,
 '1140': 0,
 '1139': 0,
 '1138': 0,
 '1137': 0,
 '1136': 0,
 '1135': 0,
 '1134': 0,
 '1133': 0,
 '1132': 0,
 '1131': 0,
 '1130': 0,
 '1129': 0,
 '1128': 0,
 '1127': 0,
 '1126': 0,
 '1125': 0,
 '1124': 0,
 '1123': 0,
 '1122': 0,
 '1121': 0,
 '1120': 0,
 '1119': 0,
 '1118': 0,
 '1117': 0,
 '1116': 0,
 '1115': 0,
 '1114': 0,
 '1113': 0,
 '1112': 0,
 '1111': 0,
 '1110': 0,
 '1109': 0,
 '1108': 0,
 '1107': 0,
 '1106': 0,
 '1105': 0,
 '1104': 0,
 '1103': 0,
 '1102': 0,
 '1101': 0,
 '1100': 0,
 '1099': 0,
 '1098': 0,
 '1097': 0,
 '1096': 0,
 '1095': 0,
 '1094': 0,
 '1093': 0,
 '1092': 0,
 '1091': 0,
 '1090': 0,
 '1089': 0,
 '1088': 0,
 '1087': 0,
 '1086': 0,
 '1085': 0,
 '1084': 0,
 '1083': 0,
 '1082': 0,
 '1081': 0,
 '1080': 0,
 '1079': 0,
 '1078': 0,
 '1077': 0,
 '1076': 0,
 '1075': 0,
 '1074': 0,
 '1073': 0,
 '1072': 0,
 '1071': 0,
 '1070': 0,
 '1069': 0,
 '1068': 0,
 '1067': 0,
 '1066': 0,
 '1065': 0,
 '1064': 0,
 '1063': 0,
 '1062': 0,
 '1061': 0,
 '1060': 0,
 '1059': 0,
 '1058': 0,
 '1057': 0,
 '1056': 0,
 '1055': 0,
 '1054': 0,
 '1053': 0,
 '1052': 0,
 '1051': 0,
'Predict': 0,
    }
])

def init():
    global model
    global scale
    model = pickle.load(open(model_path,'rb'))
    scale = joblib.load(scale_path)
    
@input_schema('Inputs', NumpyParameterType(input_sample))
@output_schema(NumpyParameterType(output_sample))
def run(Inputs):
    data = np.array(Inputs)
    start_wavelength = 1100 #start wavelength
    end_wavelength = 1350 #end wavelength
    Intensity = data.T[start_wavelength:end_wavelength]
    X1 = savgol_filter(Intensity.T, 17, polyorder = 3,deriv=2)
    data_trans = scale.transform(X1)
    y_hat = model.predict(data_trans)
    print('y_pred',y_hat)
    result = []
    print(y_hat)
    for i in range(len(y_hat)):
        row = {
            '1300': float(Inputs[i][1100]),
            '1299': float(Inputs[i][1101]),
            '1298': float(Inputs[i][1102]),
            '1297': float(Inputs[i][1103]),
            '1296': float(Inputs[i][1104]),
            '1295': float(Inputs[i][1105]),
            '1294': float(Inputs[i][1106]),
            '1293': float(Inputs[i][1107]),
            '1292': float(Inputs[i][1108]),
            '1291': float(Inputs[i][1109]),
            '1290': float(Inputs[i][1110]),
            '1289': float(Inputs[i][1111]),
            '1288': float(Inputs[i][1112]),
            '1287': float(Inputs[i][1113]),
            '1286': float(Inputs[i][1114]),
            '1285': float(Inputs[i][1115]),
            '1284': float(Inputs[i][1116]),
            '1283': float(Inputs[i][1117]),
            '1282': float(Inputs[i][1118]),
            '1281': float(Inputs[i][1119]),
            '1280': float(Inputs[i][1120]),
            '1279': float(Inputs[i][1121]),
            '1278': float(Inputs[i][1122]),
            '1277': float(Inputs[i][1123]),
            '1276': float(Inputs[i][1124]),
            '1275': float(Inputs[i][1125]),
            '1274': float(Inputs[i][1126]),
            '1273': float(Inputs[i][1127]),
            '1272': float(Inputs[i][1128]),
            '1271': float(Inputs[i][1129]),
            '1270': float(Inputs[i][1130]),
            '1269': float(Inputs[i][1131]),
            '1268': float(Inputs[i][1132]),
            '1267': float(Inputs[i][1133]),
            '1266': float(Inputs[i][1134]),
            '1265': float(Inputs[i][1135]),
            '1264': float(Inputs[i][1136]),
            '1263': float(Inputs[i][1137]),
            '1262': float(Inputs[i][1138]),
            '1261': float(Inputs[i][1139]),
            '1260': float(Inputs[i][1140]),
            '1259': float(Inputs[i][1141]),
            '1258': float(Inputs[i][1142]),
            '1257': float(Inputs[i][1143]),
            '1256': float(Inputs[i][1144]),
            '1255': float(Inputs[i][1145]),
            '1254': float(Inputs[i][1146]),
            '1253': float(Inputs[i][1147]),
            '1252': float(Inputs[i][1148]),
            '1251': float(Inputs[i][1149]),
            '1250': float(Inputs[i][1150]),
            '1249': float(Inputs[i][1151]),
            '1248': float(Inputs[i][1152]),
            '1247': float(Inputs[i][1153]),
            '1246': float(Inputs[i][1154]),
            '1245': float(Inputs[i][1155]),
            '1244': float(Inputs[i][1156]),
            '1243': float(Inputs[i][1157]),
            '1242': float(Inputs[i][1158]),
            '1241': float(Inputs[i][1159]),
            '1240': float(Inputs[i][1160]),
            '1239': float(Inputs[i][1161]),
            '1238': float(Inputs[i][1162]),
            '1237': float(Inputs[i][1163]),
            '1236': float(Inputs[i][1164]),
            '1235': float(Inputs[i][1165]),
            '1234': float(Inputs[i][1166]),
            '1233': float(Inputs[i][1167]),
            '1232': float(Inputs[i][1168]),
            '1231': float(Inputs[i][1169]),
            '1230': float(Inputs[i][1170]),
            '1229': float(Inputs[i][1171]),
            '1228': float(Inputs[i][1172]),
            '1227': float(Inputs[i][1173]),
            '1226': float(Inputs[i][1174]),
            '1225': float(Inputs[i][1175]),
            '1224': float(Inputs[i][1176]),
            '1223': float(Inputs[i][1177]),
            '1222': float(Inputs[i][1178]),
            '1221': float(Inputs[i][1179]),
            '1220': float(Inputs[i][1180]),
            '1219': float(Inputs[i][1181]),
            '1218': float(Inputs[i][1182]),
            '1217': float(Inputs[i][1183]),
            '1216': float(Inputs[i][1184]),
            '1215': float(Inputs[i][1185]),
            '1214': float(Inputs[i][1186]),
            '1213': float(Inputs[i][1187]),
            '1212': float(Inputs[i][1188]),
            '1211': float(Inputs[i][1189]),
            '1210': float(Inputs[i][1190]),
            '1209': float(Inputs[i][1191]),
            '1208': float(Inputs[i][1192]),
            '1207': float(Inputs[i][1193]),
            '1206': float(Inputs[i][1194]),
            '1205': float(Inputs[i][1195]),
            '1204': float(Inputs[i][1196]),
            '1203': float(Inputs[i][1197]),
            '1202': float(Inputs[i][1198]),
            '1201': float(Inputs[i][1199]),
            '1200': float(Inputs[i][1200]),
            '1199': float(Inputs[i][1201]),
            '1198': float(Inputs[i][1202]),
            '1197': float(Inputs[i][1203]),
            '1196': float(Inputs[i][1204]),
            '1195': float(Inputs[i][1205]),
            '1194': float(Inputs[i][1206]),
            '1193': float(Inputs[i][1207]),
            '1192': float(Inputs[i][1208]),
            '1191': float(Inputs[i][1209]),
            '1190': float(Inputs[i][1210]),
            '1189': float(Inputs[i][1211]),
            '1188': float(Inputs[i][1212]),
            '1187': float(Inputs[i][1213]),
            '1186': float(Inputs[i][1214]),
            '1185': float(Inputs[i][1215]),
            '1184': float(Inputs[i][1216]),
            '1183': float(Inputs[i][1217]),
            '1182': float(Inputs[i][1218]),
            '1181': float(Inputs[i][1219]),
            '1180': float(Inputs[i][1220]),
            '1179': float(Inputs[i][1221]),
            '1178': float(Inputs[i][1222]),
            '1177': float(Inputs[i][1223]),
            '1176': float(Inputs[i][1224]),
            '1175': float(Inputs[i][1225]),
            '1174': float(Inputs[i][1226]),
            '1173': float(Inputs[i][1227]),
            '1172': float(Inputs[i][1228]),
            '1171': float(Inputs[i][1229]),
            '1170': float(Inputs[i][1230]),
            '1169': float(Inputs[i][1231]),
            '1168': float(Inputs[i][1232]),
            '1167': float(Inputs[i][1233]),
            '1166': float(Inputs[i][1234]),
            '1165': float(Inputs[i][1235]),
            '1164': float(Inputs[i][1236]),
            '1163': float(Inputs[i][1237]),
            '1162': float(Inputs[i][1238]),
            '1161': float(Inputs[i][1239]),
            '1160': float(Inputs[i][1240]),
            '1159': float(Inputs[i][1241]),
            '1158': float(Inputs[i][1242]),
            '1157': float(Inputs[i][1243]),
            '1156': float(Inputs[i][1244]),
            '1155': float(Inputs[i][1245]),
            '1154': float(Inputs[i][1246]),
            '1153': float(Inputs[i][1247]),
            '1152': float(Inputs[i][1248]),
            '1151': float(Inputs[i][1249]),
            '1150': float(Inputs[i][1250]),
            '1149': float(Inputs[i][1251]),
            '1148': float(Inputs[i][1252]),
            '1147': float(Inputs[i][1253]),
            '1146': float(Inputs[i][1254]),
            '1145': float(Inputs[i][1255]),
            '1144': float(Inputs[i][1256]),
            '1143': float(Inputs[i][1257]),
            '1142': float(Inputs[i][1258]),
            '1141': float(Inputs[i][1259]),
            '1140': float(Inputs[i][1260]),
            '1139': float(Inputs[i][1261]),
            '1138': float(Inputs[i][1262]),
            '1137': float(Inputs[i][1263]),
            '1136': float(Inputs[i][1264]),
            '1135': float(Inputs[i][1265]),
            '1134': float(Inputs[i][1266]),
            '1133': float(Inputs[i][1267]),
            '1132': float(Inputs[i][1268]),
            '1131': float(Inputs[i][1269]),
            '1130': float(Inputs[i][1270]),
            '1129': float(Inputs[i][1271]),
            '1128': float(Inputs[i][1272]),
            '1127': float(Inputs[i][1273]),
            '1126': float(Inputs[i][1274]),
            '1125': float(Inputs[i][1275]),
            '1124': float(Inputs[i][1276]),
            '1123': float(Inputs[i][1277]),
            '1122': float(Inputs[i][1278]),
            '1121': float(Inputs[i][1279]),
            '1120': float(Inputs[i][1280]),
            '1119': float(Inputs[i][1281]),
            '1118': float(Inputs[i][1282]),
            '1117': float(Inputs[i][1283]),
            '1116': float(Inputs[i][1284]),
            '1115': float(Inputs[i][1285]),
            '1114': float(Inputs[i][1286]),
            '1113': float(Inputs[i][1287]),
            '1112': float(Inputs[i][1288]),
            '1111': float(Inputs[i][1289]),
            '1110': float(Inputs[i][1290]),
            '1109': float(Inputs[i][1291]),
            '1108': float(Inputs[i][1292]),
            '1107': float(Inputs[i][1293]),
            '1106': float(Inputs[i][1294]),
            '1105': float(Inputs[i][1295]),
            '1104': float(Inputs[i][1296]),
            '1103': float(Inputs[i][1297]),
            '1102': float(Inputs[i][1298]),
            '1101': float(Inputs[i][1299]),
            '1100': float(Inputs[i][1300]),
            '1099': float(Inputs[i][1301]),
            '1098': float(Inputs[i][1302]),
            '1097': float(Inputs[i][1303]),
            '1096': float(Inputs[i][1304]),
            '1095': float(Inputs[i][1305]),
            '1094': float(Inputs[i][1306]),
            '1093': float(Inputs[i][1307]),
            '1092': float(Inputs[i][1308]),
            '1091': float(Inputs[i][1309]),
            '1090': float(Inputs[i][1310]),
            '1089': float(Inputs[i][1311]),
            '1088': float(Inputs[i][1312]),
            '1087': float(Inputs[i][1313]),
            '1086': float(Inputs[i][1314]),
            '1085': float(Inputs[i][1315]),
            '1084': float(Inputs[i][1316]),
            '1083': float(Inputs[i][1317]),
            '1082': float(Inputs[i][1318]),
            '1081': float(Inputs[i][1319]),
            '1080': float(Inputs[i][1320]),
            '1079': float(Inputs[i][1321]),
            '1078': float(Inputs[i][1322]),
            '1077': float(Inputs[i][1323]),
            '1076': float(Inputs[i][1324]),
            '1075': float(Inputs[i][1325]),
            '1074': float(Inputs[i][1326]),
            '1073': float(Inputs[i][1327]),
            '1072': float(Inputs[i][1328]),
            '1071': float(Inputs[i][1329]),
            '1070': float(Inputs[i][1330]),
            '1069': float(Inputs[i][1331]),
            '1068': float(Inputs[i][1332]),
            '1067': float(Inputs[i][1333]),
            '1066': float(Inputs[i][1334]),
            '1065': float(Inputs[i][1335]),
            '1064': float(Inputs[i][1336]),
            '1063': float(Inputs[i][1337]),
            '1062': float(Inputs[i][1338]),
            '1061': float(Inputs[i][1339]),
            '1060': float(Inputs[i][1340]),
            '1059': float(Inputs[i][1341]),
            '1058': float(Inputs[i][1342]),
            '1057': float(Inputs[i][1343]),
            '1056': float(Inputs[i][1344]),
            '1055': float(Inputs[i][1345]),
            '1054': float(Inputs[i][1346]),
            '1053': float(Inputs[i][1347]),
            '1052': float(Inputs[i][1348]),
            '1051': float(Inputs[i][1349]),
            "Predict_Pen": float(y_hat[i])
        }
        result.append(row)

    return result